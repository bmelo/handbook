
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pygers Workshop Notes - Week 2 (Fall 2020) &#8212; The Princeton Handbook for Reproducible Neuroimaging</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="canonical" href="https://brainhack-princeton.github.io/handbook//content_pages/pygers_workshops/fall_2020/workshop_notes_week2.html" />
    <link rel="shortcut icon" href="../../../_static/tigerBrain_favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    div.body {
      min-width: initial;
      max-width: initial;
    }
  </style>

  
  <link rel="canonical" href="https://handbook.datalad.org/content_pages/pygers_workshops/fall_2020/workshop_notes_week2/"/>
  <meta property="og:url" content="https://handbook.datalad.org/content_pages/pygers_workshops/fall_2020/workshop_notes_week2">
  

  <link rel="icon" type="image/png" href="https://media.readthedocs.org/images/favicon.png">

  <meta name="twitter:card" content="summary">
  <meta property="twitter:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:title" content="Pygers Workshop Notes - Week 2 (Fall 2020) &#8212; The Princeton Handbook for Reproducible Neuroimaging">
  <meta property="og:type" content="article">
  
  <meta property="og:description" content="">


  </head><body>
  <script type="text/javascript">

  $(window).scroll(function () {
    var s = $(window).scrollTop(),
          d = $(document).height(),
          c = $(window).height();
          scrollPercent = (s / (d-c)) * 100;
          var position = scrollPercent;

     $("#progressbar").attr('value', position);
  });
  </script>

  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="../../../index.html">
    <img class="logo" width="500" src="../../../_static/tigerBrain.png" title="The Princeton Handbook on Reproducible Neuroimaging"/>
  </a>
</p>

<!-- <p style="margin-left:auto; margin-right: auto;"><iframe src="https://ghbtns.com/github-btn.html?repo=book&user=datalad-handbook&type=star&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe></p> -->

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> -->
<style>
.algolia-autocomplete{
  width: 100%;
  height: 1.5em
}
.algolia-autocomplete a{
  border-bottom: none !important;
}
#doc_search{
  width: 100%;
  height: 100%;
}
</style>

<progress id="progressbar" value="0" max="100"></progress>
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pygers Workshop Notes - Week 2 (Fall 2020)</a><ul>
<li><a class="reference internal" href="#what-is-conda-why-do-we-use-it">What is Conda? Why do we use it?</a></li>
<li><a class="reference internal" href="#set-up-a-pygers-conda-environment">Set up a pygers conda environment</a></li>
<li><a class="reference internal" href="#what-is-git-and-why-should-we-use-it-and-what-is-github">What is Git and why should we use it? And what is GitHub?</a></li>
<li><a class="reference internal" href="#demo-familiarize-yourself-with-git">Demo: familiarize yourself with Git!</a></li>
<li><a class="reference internal" href="#using-git-github-with-our-sample-project">Using Git/GitHub with our sample project</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><!-- Alabaster (krTheme++) Hacks -->
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            <div style="display:block;position:relative; margin-bottom: 1em;">
              <div style="display:block;width:100%;padding-top:12.5%;"></div>
              <div class="rpad" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
            </div>
            
  <div class="section" id="pygers-workshop-notes-week-2-fall-2020">
<h1>Pygers Workshop Notes - Week 2 (Fall 2020)<a class="headerlink" href="#pygers-workshop-notes-week-2-fall-2020" title="Permalink to this headline">¶</a></h1>
<style> .blue {color:blue} </style><div class="section" id="what-is-conda-why-do-we-use-it">
<h2>What is Conda? Why do we use it?<a class="headerlink" href="#what-is-conda-why-do-we-use-it" title="Permalink to this headline">¶</a></h2>
<p><em>Conda</em> is a <strong>package manager</strong>, similar to brew, apt, or pip. This package manager keeps track of your Python installation, versions, and dependencies in an encapsulated <strong>environment</strong> that can be easily shared or reproduced. This is helpful if you have multiple projects that require different (potentially conflicting) software versions. You can activate and deactivate conda environments, and we’ll use conda to install new packages into our environment.</p>
<p><em>Anaconda</em> is a free and open source <strong>software distribution</strong> for scientific computing that is managed by conda. <em>Miniconda</em> is a minimal version of Anaconda.</p>
<p>Here’s a <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/cheatsheet.html">conda cheatsheet</a> you can use to familiarize yourself with this package manager.</p>
</div>
<div class="section" id="set-up-a-pygers-conda-environment">
<h2>Set up a pygers conda environment<a class="headerlink" href="#set-up-a-pygers-conda-environment" title="Permalink to this headline">¶</a></h2>
<p>You should setup your conda environment on the same computer as your pygers_workshop working directory (i.e. either on your local machine if you are working locally, or on the server if you are working on the server). Follow the correct installation instructions below.</p>
<p>Server installation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># download latest miniconda for Linux in your home directory</span>
$ <span class="nb">cd</span> ~
$ wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh

<span class="c1"># run installation</span>
$ bash Miniconda3-latest-Linux-x86_64.sh

<span class="c1"># if you don&#39;t want this base environment automatically loaded when you login:</span>
$ conda config --set auto_activate_base <span class="nb">false</span>

<span class="c1"># source and take a look at your .bashrc</span>
$ <span class="nb">source</span> .bashrc
$ vim .bashrc

<span class="c1"># you can delete the installation file if you want</span>
$ rm -r Miniconda3-latest-Linux-x86_64.sh
</pre></div>
</div>
<p>Local installation (on MacOSX):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># download latest miniconda for MacOSX in your downloads directory</span>
$ <span class="nb">cd</span> ~/Downloads
$ curl -O  https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh

<span class="c1"># run installation (it should install in your home directory by default)</span>
$ bash Miniconda3-latest-MacOSX-x86_64.sh

<span class="c1"># if you don&#39;t want this base environment automatically loaded when you login:</span>
$ conda config --set auto_activate_base <span class="nb">false</span>

<span class="c1"># source and take a look at your .bashrc</span>
$ <span class="nb">cd</span> ~
$ <span class="nb">source</span> .bash_profile
$ vim .bash_profile

<span class="c1"># you can delete the installation file if you want</span>
$ rm -r ~/Downloads/Miniconda3-latest-MacOSX-x86_64.sh
</pre></div>
</div>
<p>Everybody can now continue the conda setup following the same set of instructions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># check your conda setup</span>
$ <span class="nb">cd</span> ~
$ which conda <span class="c1">#see where it is installed</span>
$ conda env list <span class="c1">#you should see a base environment listed</span>
$ conda --version <span class="c1">#latest is 4.8.5 as of Oct-12-2020</span>
$ conda --help <span class="c1">#useful commands</span>

<span class="c1"># if you need to update conda</span>
$ conda update -n base -c defaults conda

<span class="c1"># create environment called pygers</span>
$ conda create -n pygers
$ conda env list

<span class="c1"># activate your pygers environment</span>
$ conda activate pygers

<span class="c1"># check your python version</span>
$ python --version <span class="c1">#latest is 3.8.5 as of Oct-12-2020</span>
<span class="c1"># make sure you have python version 3.8 (as opposed to 2.7)</span>

<span class="c1"># if you need to update python:</span>
$ conda install python
$ python --version

<span class="c1"># install packages into your pygers environment</span>
$ conda install git numpy pandas jupyter

<span class="c1"># check your install; versions listed are latest as of Oct-12-2020</span>
$ conda list
$ git --version <span class="c1">#2.23.0</span>
$ jupyter --version <span class="c1">#core is 4.6.3</span>
$ python -c <span class="s2">&quot;import numpy; print(numpy.version.version)&quot;</span> <span class="c1">#1.19.1</span>
$ python -c <span class="s2">&quot;import pandas; print(pandas.__version__)&quot;</span> <span class="c1">#1.1.3</span>

<span class="c1"># deactivate conda environment</span>
$ conda deactivate
</pre></div>
</div>
</div>
<div class="section" id="what-is-git-and-why-should-we-use-it-and-what-is-github">
<h2>What is Git and why should we use it? And what is GitHub?<a class="headerlink" href="#what-is-git-and-why-should-we-use-it-and-what-is-github" title="Permalink to this headline">¶</a></h2>
<p><em>Git</em> is a <strong>version control system</strong> for tracking changes to your code over time. Git can track the history of your code; this means that if you mess something up, you can go back in time and recover a previous version of your code. Providing the full provenance of your code also makes your workflow more transparent for others. Here’s a <a class="reference external" href="https://education.github.com/git-cheat-sheet-education.pdf">Git cheatsheet</a> to familiarize yourself with version control using Git.</p>
<p><em>GitHub</em> is a <strong>web platform</strong> that hosts collaborative software development and distribution using Git. The web interface allows you to see the history of your code and share your code with others. For more information about Git and GitHub, check out <a class="reference external" href="https://codeburst.io/git-and-github-in-a-nutshell-b0a3cc06458f">this article</a>!</p>
</div>
<div class="section" id="demo-familiarize-yourself-with-git">
<h2>Demo: familiarize yourself with Git!<a class="headerlink" href="#demo-familiarize-yourself-with-git" title="Permalink to this headline">¶</a></h2>
<p>In the following, we’ll work through a simple exercise of version control with Git. We’ll use a simple Python script to demo staging and committing changes, viewing your history, going back in time, and sharing code via GitHub.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># activate conda environment and check git version</span>
$ conda activate pygers
$ git --version

<span class="c1"># check if git identity is configured</span>

$ git config --list <span class="c1"># check for user.name and user.email</span>

<span class="c1"># otherwise configure your name and email</span>
$ git config --global --add user.name <span class="s2">&quot;FirstName LastName&quot;</span>

$ git config --global --add user.email youremail@blah.com


<span class="c1"># create a git demo directory in pygers_workshop</span>
$ mkdir git-demo
$ <span class="nb">cd</span> git-demo

<span class="c1"># initialize a git repository (repo) in this directory</span>
$ git init

<span class="c1"># create silly example python script</span>
$ vim division.py

<span class="c1"># enter this into your text editor:</span>
<span class="nv">n</span> <span class="o">=</span> int<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter numerator: &quot;</span><span class="o">))</span>
<span class="nv">d</span> <span class="o">=</span> int<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter denominator: &quot;</span><span class="o">))</span>
print<span class="o">(</span>n / d<span class="o">)</span>

<span class="c1"># check git status now that we have a new file</span>
$ git status

<span class="c1"># add the new file to the staging area</span>
$ git add division.py
$ git status

<span class="c1"># commit the new changes with an informative message</span>
$ git commit -m “Create division.py to cause me headaches later”

<span class="c1"># check the git log to see the commit history so far</span>
$ git status
$ git log <span class="c1"># also try `git log -p -n 1` or `git log --oneline`</span>

<span class="c1"># try running our silly python script</span>
$ python division.py <span class="c1"># enter some numbers</span>

<span class="c1"># note that floats break this script</span>
<span class="c1"># check your python version then try division with remainder</span>
<span class="c1"># if you&#39;re using python 3, the ouput should be a fractional float</span>
<span class="c1"># if you&#39;re using python 2, the default is integer division (yikes)</span>

<span class="c1"># let&#39;s make an adjustment to our script</span>
$ vim division.py

<span class="c1"># enter this into your text editor:</span>
def num<span class="o">(</span>n<span class="o">)</span>:
    try:
        <span class="k">return</span> int<span class="o">(</span>n<span class="o">)</span>
    except ValueError:
        <span class="k">return</span> float<span class="o">(</span>n<span class="o">)</span>

<span class="nv">n</span> <span class="o">=</span> num<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter numerator: &quot;</span><span class="o">))</span>
<span class="nv">d</span> <span class="o">=</span> num<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter denominator: &quot;</span><span class="o">))</span>
print<span class="o">(</span>n / d<span class="o">)</span>

<span class="c1"># add and commit new changes</span>
$ git status
$ git add division.py <span class="c1"># or git add -u</span>
$ git commit -m “Update division.py to tolerate floats”

<span class="c1"># let&#39;s add a shebang to script</span>
$ vim division.py

<span class="c1"># enter this into your text editor:</span>
<span class="c1">#!/usr/bin/env python</span>

def num<span class="o">(</span>n<span class="o">)</span>:
    try:
        <span class="k">return</span> int<span class="o">(</span>n<span class="o">)</span>
    except ValueError:
        <span class="k">return</span> float<span class="o">(</span>n<span class="o">)</span>

<span class="nv">n</span> <span class="o">=</span> num<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter numerator: &quot;</span><span class="o">))</span>
<span class="nv">d</span> <span class="o">=</span> num<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter denominator: &quot;</span><span class="o">))</span>
print<span class="o">(</span>n / d<span class="o">)</span>

<span class="c1"># and commit this third change</span>
$ git add division.py
$ git commit -m <span class="s2">&quot;Add python shebang to division.py&quot;</span>

<span class="c1"># how is git tracking all this</span>
$ ls -al <span class="c1"># see hidden .git dot-files</span>

<span class="c1"># view differences between commits</span>
$ git log
$ git diff SHA SHA <span class="c1"># diff between two commit hashes</span>

<span class="c1"># snoop around in the past using git checkout</span>
$ git checkout SHA <span class="c1"># go back to your first commit</span>
$ less division.py <span class="c1"># our script is in its previous state</span>
$ git log <span class="c1"># the log is in its previous state</span>

<span class="c1"># okay let&#39;s go back to the future</span>
$ git checkout master

<span class="c1"># undo recent commit(s) using reset</span>
$ git log
$ git reset --mixed SHA
$ git log <span class="c1"># git log is in previous state</span>

<span class="c1"># modify the script for a new commit</span>
$ vim division.py <span class="c1"># our prior changes are still present</span>

<span class="c1"># modify this line in your text editor:</span>
<span class="c1">#!/usr/bin/env python3 # update our shebang to python3</span>

<span class="c1"># commit this version instead</span>
$ git add division.py
$ git commit -m <span class="s2">&quot;Add python3 shebang to division.py&quot;</span>
$ git log

<span class="c1"># we can still find our orphaned commit (for now)</span>
$ git reflog <span class="c1"># get commit hash for “Update…”</span>
$ git checkout SHA <span class="c1"># or git reset to return to this commit</span>
$ git checkout master

<span class="c1"># create empty repository with no README, LICENSE on GitHub</span>
$ git remote add origin https://github.com/snastase/git-demo.git
$ git push -u origin master

<span class="c1"># create README on GitHub</span>
$ git pull
$ ls

<span class="c1"># on GitHub, click “Add file”, type LICENSE, and then click Choose license</span>
$ git pull
$ ls

<span class="c1"># switch to another computer and clone repo from GitHub</span>
$ git clone https://github.com/snastase/git-demo.git

<span class="c1"># make some changes on your other computer</span>
$ vim division.py

<span class="c1"># update the script in your text editor:</span>
<span class="c1">#!/usr/bin/env python3</span>

def num<span class="o">(</span>n<span class="o">)</span>:
    try:
        <span class="k">return</span> int<span class="o">(</span>n<span class="o">)</span>
    except ValueError:
        <span class="k">return</span> float<span class="o">(</span>n<span class="o">)</span>

<span class="nv">n</span> <span class="o">=</span> num<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter numerator: &quot;</span><span class="o">))</span>
<span class="nv">d</span> <span class="o">=</span> num<span class="o">(</span>input<span class="o">(</span><span class="s2">&quot;Enter denominator: &quot;</span><span class="o">))</span>
print<span class="o">(</span>f<span class="s2">&quot;Result: {n / d}&quot;</span><span class="o">)</span>

<span class="c1"># commit and push changes to GitHub</span>
$ git add division.py
$ git commit -m <span class="s2">&quot;Update result output format&quot;</span>
$ git push

<span class="c1"># switch back to other computer and synchronize changes</span>
$ git pull

<span class="c1"># rename a file with git mv</span>
$ git mv division.py divide.py

<span class="c1"># untrack tracked file</span>
$ git rm --cached division.py

<span class="c1"># amend previous commit message</span>
$ git commit --amend
</pre></div>
</div>
<p>This is only a thin slice of Git functionality; there are many other powerful features. For example, check out the “<a class="reference internal" href="../../06-04-contributing.html#contribute"><span class="std std-ref">How to contribute</span></a>” page of our handbook to familiarize yourself with the workflow for using Git to contribute to an existing software package.</p>
</div>
<div class="section" id="using-git-github-with-our-sample-project">
<h2>Using Git/GitHub with our sample project<a class="headerlink" href="#using-git-github-with-our-sample-project" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Create a new GitHub repository (<a class="reference external" href="https://docs.github.com/en/enterprise/2.15/user/articles/create-a-repo">link</a> to instructions) where you will track the files inside <span class="blue">pygers_workshop/sample_project/code/</span>.</p></li>
<li><p>Our sample project, which you copied last week, already has a .git attached to it that is <a class="reference external" href="https://github.com/brainhack-princeton/handbook-code">linked</a> to a repo on our Pygers GitHub account:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the URL that Git has stored in local repo</span>
$ git remote -v
<span class="c1"># OUTPUT:</span>
<span class="c1">#   origin    https://github.com/brainhack-princeton/handbook-code.git (fetch)</span>
<span class="c1">#   origin    https://github.com/brainhack-princeton/handbook-code.git (push)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>You want to remove the link to the Pygers GitHub account and link it to the repo you created in Step 1 in your own GitHub account:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> <span class="o">[</span>YOUR_LOCAL_PATH<span class="o">]</span>/pygers_workshop/sample_project/code/
$ git remote -v
$ git remote rm origin
$ git remote add origin <span class="o">[</span>URL_TO_YOUR-REPO<span class="o">]</span>
<span class="c1"># confirm that your origin remote is linked to your github repo</span>
$ git remote -v
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Push the changes to your GitHub repo (in a way to automatically push to your repo in the future).</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git push -u origin master
</pre></div>
</div>
<p>Refresh your GitHub page online. You should be able to see the contents inside <span class="blue">pygers_workshop/sample_project/code/</span> on the repo.</p>
<ol class="arabic simple" start="5">
<li><p>Add .DS_Store to your your .gitignore and push it to your GitHub.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git status <span class="c1"># .DS_Store should appear in the list of untracked files</span>
$ vim .gitignore

<span class="c1"># enter insert mode (i) and add the following:</span>
<span class="c1"># .DS_Store</span>
<span class="c1"># go back to command mode (esc)</span>
<span class="c1"># :x to save and exit</span>

$ git add .gitignore
$ git commit -m <span class="s2">&quot;adding gitignore&quot;</span>
$ git push
$ git status <span class="c1"># .DS_Store should NOT appear in the list of untracked files</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>There are several things you need to change in the <span class="blue">globals.sh</span> file. Edit these things using vim (<cite>vim preprocessing/globals.sh</cite>)</p></li>
</ol>
<ul class="simple">
<li><p>Comment out <cite>module load anacondapy/5.3.1</cite></p></li>
<li><dl class="simple">
<dt>Set the <strong>scanner_dir</strong> to the location where the data lives:</dt><dd><ul>
<li><p>for PNI folks, the location is <span class="blue">/jukebox/norman/pygers/conquest</span></p></li>
<li><p>fot non-PNI folks, this should be the path to where you downloaded and saved the sample data</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Edit <strong>project_dir</strong> to where you have the sample_study directory (e.g., /jukebox/LAB/YOURNAME/pygers_workshop/sample_study)</p></li>
</ul>
<p>Now, you need to commit and push the changes to your globals.sh file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git add preprocessing/globals.sh
$ git commit -m <span class="s2">&quot;updating globals directory&quot;</span>
$ git push
</pre></div>
</div>
<p><a class="reference external" href="./syllabus2020.html">Return to workshop info</a></p>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
  <div style="text-align: left;" id="waldo-tag-2171"></div>
  <p>&copy;2020 CC-BY-SA - <a href="website_info.html">Website Info</a></p>
</div>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>