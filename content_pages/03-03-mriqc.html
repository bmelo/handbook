
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quality control with MRIQC &#8212; The Princeton Handbook for Reproducible Neuroimaging</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="canonical" href="https://brainhack-princeton.github.io/handbook//content_pages/03-03-mriqc.html" />
    <link rel="shortcut icon" href="../_static/tigerBrain_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Preprocessing with fMRIprep" href="03-04-fmriprep.html" />
    <link rel="prev" title="Converting data to BIDS using HeuDiConv" href="03-02-converting.html" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    div.body {
      min-width: initial;
      max-width: initial;
    }
  </style>

  
  <link rel="canonical" href="https://handbook.datalad.org/content_pages/03-03-mriqc/"/>
  <meta property="og:url" content="https://handbook.datalad.org/content_pages/03-03-mriqc">
  

  <link rel="icon" type="image/png" href="https://media.readthedocs.org/images/favicon.png">

  <meta name="twitter:card" content="summary">
  <meta property="twitter:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:title" content="Quality control with MRIQC &#8212; The Princeton Handbook for Reproducible Neuroimaging">
  <meta property="og:type" content="article">
  
  <meta property="og:description" content="">


  </head><body>
  <script type="text/javascript">

  $(window).scroll(function () {
    var s = $(window).scrollTop(),
          d = $(document).height(),
          c = $(window).height();
          scrollPercent = (s / (d-c)) * 100;
          var position = scrollPercent;

     $("#progressbar").attr('value', position);
  });
  </script>

  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="../index.html">
    <img class="logo" width="500" src="../_static/tigerBrain.png" title="The Princeton Handbook on Reproducible Neuroimaging"/>
  </a>
</p>

<!-- <p style="margin-left:auto; margin-right: auto;"><iframe src="https://ghbtns.com/github-btn.html?repo=book&user=datalad-handbook&type=star&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe></p> -->

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /> -->
<style>
.algolia-autocomplete{
  width: 100%;
  height: 1.5em
}
.algolia-autocomplete a{
  border-bottom: none !important;
}
#doc_search{
  width: 100%;
  height: 100%;
}
</style>

<progress id="progressbar" value="0" max="100"></progress>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Quality control with MRIQC</a><ul>
<li><a class="reference internal" href="#running-mriqc">Running MRIQC</a><ul>
<li><a class="reference internal" href="#before-running-for-the-first-time"><em>Before running for the first time</em></a></li>
<li><a class="reference internal" href="#submit-your-mriqc-job"><em>Submit your MRIQC job</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mriqc-outputs">MRIQC Outputs</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="03-02-converting.html" title="previous chapter">Converting data to BIDS using HeuDiConv</a></li>
      <li>Next: <a href="03-04-fmriprep.html" title="next chapter">Preprocessing with fMRIprep</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><!-- Alabaster (krTheme++) Hacks -->
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            <div style="display:block;position:relative; margin-bottom: 1em;">
              <div style="display:block;width:100%;padding-top:12.5%;"></div>
              <div class="rpad" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
            </div>
            
  <div class="section" id="quality-control-with-mriqc">
<span id="mriqc"></span><h1>Quality control with MRIQC<a class="headerlink" href="#quality-control-with-mriqc" title="Permalink to this headline">¶</a></h1>
<style> .blue {color:blue} </style>
<style> .red {color:red} </style><p>To get an idea of the quality of your fMRI data, you can use the MRI Quality Check (MRIQC) BIDS app.</p>
<div class="section" id="running-mriqc">
<h2>Running MRIQC<a class="headerlink" href="#running-mriqc" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">slurm_mriqc.sh</span></code> script (which you can find in the <span class="blue">code/preprocessing/</span> directory) will run MRIQC on the cluster using the SLURM scheduler. It first computes metrics for all runs for an individual subject, followed by the group summary statistics.</p>
<p>This script will use the following two scripts:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">run_mriqc.sh</span></code> (this runs MRIQC at the subject level)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run_mriqc_group.sh</span></code> (this compiles group summary statistics)</p></li>
</ul>
<div class="section" id="before-running-for-the-first-time">
<h3><em>Before running for the first time</em><a class="headerlink" href="#before-running-for-the-first-time" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Open slurm_mriqc.sh and update the array number to list the subjects you want to run through MRIQC. You can run multiple subjects in parallel by using arrays (e.g., #SBATCH –array=001,002,003,004).</p></li>
<li><p>Update the #SBATCH –mail-user line to include your email address if you want to get email alerts when the job begins, ends, or fails.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remember, in SLURM scripts, lines that start with <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code> are SLURM commands, not comments! All other lines that start with <code class="docutils literal notranslate"><span class="pre">#</span></code> are regular comments.</p>
</div>
</div>
<div class="section" id="submit-your-mriqc-job">
<h3><em>Submit your MRIQC job</em><a class="headerlink" href="#submit-your-mriqc-job" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Make sure you are in the directory where the slurm script lives (<span class="blue">code/preprocessing/</span>). Then use sbatch command to submit the job.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># make sure you are in the code/preprocessing directory</span>
<span class="nb">cd</span> /jukebox/YOURLAB/USERNAME/YOURSTUDY/code/preprocessing/

<span class="c1"># submit the job</span>
sbatch slurm_mriqc.sh
</pre></div>
</div>
</div>
</div>
<div class="section" id="mriqc-outputs">
<h2>MRIQC Outputs<a class="headerlink" href="#mriqc-outputs" title="Permalink to this headline">¶</a></h2>
<p>MRIQC outputs will live in <span class="blue">/data/bids/derivatives/mriqc/</span></p>
<p>MRIQC outputs separate MRIQC reports for each individual run, as well as group reports. To have a quick look at the quality of the data acquired for your subjects, a good first start is to look at the group bold report to see if the <a class="reference external" href="https://mriqc.readthedocs.io/en/stable/measures.html">image quality metrics</a> show any outlier runs with respect to the quality of the data of your whole sample. When this is the case, you should check the individual run report to see if you can figure out what went wrong. You can simply click on the data point of interest on the group report, and it will automatically open the corresponding individual run report. It is recommended that you always check the framewise displacement and temporal SNR.</p>
<a class="reference external image-reference" href="01-07-overview.html"><img alt="return to timeline" class="align-center" src="../_images/return_to_timeline.png" style="width: 300px;" /></a>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="03-02-converting.html" title="Previous document">Converting data to BIDS using HeuDiConv</a>
        </li>
        <li>
          <a href="03-04-fmriprep.html" title="Next document">Preprocessing with fMRIprep</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer">
  <div style="text-align: left;" id="waldo-tag-2171"></div>
  <p>&copy;2020 CC-BY-SA - <a href="website_info.html">Website Info</a></p>
</div>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>